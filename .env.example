# For Vercel Postgres / Neon connection.
# Set either POSTGRES_URL or DATABASE_URL in your deployment environment.
POSTGRES_URL=
# DATABASE_URL=

# V0.2.3: External PI Detection Tools (Optional)
# Enable external prompt-injection detection using Z.AI OpenAI-compatible API
# Set these values to enable external PI detection:
ZAI_API_KEY=
ZAI_API_BASE_URL=https://api.z.ai/api/coding/paas/v4
ZAI_PI_MODEL=glm-4.5
PROMPTFOO_TIMEOUT=10000

# Note: External tools are used as primary detector.
# Local PI rules are automatically used as fallback when external tools fail.

# V0.2.3.5: Abuse Control Guardrails
# Rate limiting and concurrency controls to prevent API abuse
# All values are optional; safe defaults are applied when not set.

# Time window for rate limiting (milliseconds)
# Default: 60000 (60 seconds)
SCAN_RATE_LIMIT_WINDOW_MS=60000

# Maximum requests allowed per time window per IP
# Default: 10 requests per 60 seconds
SCAN_RATE_LIMIT_MAX_REQUESTS=10

# Maximum concurrent scans allowed globally
# Default: 4 concurrent scans
SCAN_MAX_INFLIGHT=4

# Hard timeout for full scan execution (milliseconds)
# Default: 45000 (45 seconds)
# Recommended for cloud npm/GitHub scans: 90000-120000
SCAN_HARD_TIMEOUT_MS=90000

# Source intake timeout (GitHub tree/blob + npm metadata/tarball) in milliseconds
# Default: 25000
# Recommended for cloud scans: 45000-60000
SCAN_INTAKE_TIMEOUT_MS=45000
